/*!
 * Metascraper JavaScript Library v0.8.0
 * https://metascraper.com/
 *
 * Copyright Metascraper
 * Released under the MIT license
 * https://en.wikipedia.org/wiki/MIT_License
 *
 * Date: 2019-03-19T12:34Z
 */

var meta={projectName:"Metascraper",version:"0.8.0",modes:{developer:0,warning:5,error:9},options:{webApiPrefix:"http://localhost:54702/api/",attrName:"data-value",attrMemberName:"data-member",attrArrayName:"data-array",attrTextName:"data-text",attrHrefName:"data-href",attrClickName:"data-click",attrTypeName:"data-type",attrClassName:"data-class",attrScrapeName:"data-scrape",indexName:"{{*index}}",tokenName:"Token",scrape:true,mode:5},loadTypesEnum:Object.freeze({Replace:0,BeforeBeginAppend:1,AfterBeginAppend:2,BeforeEndAppend:3,AfterEndAppend:4}),storeTypesEnum:Object.freeze({ExpiryNoExtend:1,ExpiryExtend:2,OneTimeRead:3,Forever:4,Session:5}),dataTypesEnum:Object.freeze({date:"date",time:"time",datetime:"datetime",month:"month",month1:"month1",month3:"month3",monthNum:"monthNum",monthNumPad:"monthNumPad",day:"day",day1:"day1",day2:"day2",day3:"day3",dayNum:"dayNum",dayNumPad:"dayNumPad",year:"year",year2:"year2",string:"string",number:"number",json:"json"}),send:function(opts){var shouldScrape=meta.options.scrape;if(typeof opts.scrape!=='undefined'){shouldScrape=opts.scrape}var request=shouldScrape?this.scrape(true):{};if(opts.data){if(!request.data){request.data={}}this.extend(request.data,opts.data)}var o={contentType:"application/json",dataType:"json",data:request};this.extend(o,opts);if(o.url.indexOf('://')===-1){o.url=this.options.webApiPrefix+o.url}this.tokenize(o);this.ajax(o)},receive:function(opts){var success=opts.success;var o={contentType:"application/json",dataType:"json"};this.extend(o,opts);o.success=function(data,textStatus,jqXHR){meta.bind(data);if(success){success(data,textStatus,jqXHR)}}var idx=o.url.indexOf('://');if(idx===-1||idx>7){o.url=this.options.webApiPrefix+o.url}this.tokenize(o);this.ajax(o)},get:function(opts){var d={method:"GET"};this.extend(d,opts);this.receive(d)},post:function(opts){var d={method:"POST"};this.extend(d,opts);this.send(d)},put:function(opts){var d={method:"PUT"};this.extend(d,opts);this.send(d)},del:function(opts){var d={method:"DELETE"};this.extend(d,opts);this.send(d)},create:function(opts){this.post(opts)},read:function(opts){this.get(opts)},update:function(opts){this.put(opts)},save:function(opts){if(this.isNullOrUndefined(opts.pk)||opts.pk.length===0){throw arguments.callee.toString()+' - required parameter [pk] not found'}opts.data=this.scrape();opts.scrape=false;if(opts.data[opts.pk]&&opts.data[opts.pk]!=="0"){meta.update(opts)}else{meta.create(opts)}},authorize:function(opts){var noToken=meta.isNullOrUndefined(this.token());if(noToken&&opts&&opts.url){window.location.href=opts.url}return!noToken},token:function(){var store=window.localStorage;return store.getItem(meta.options.tokenName)},tokenize:function(opts){var token=meta.token();if(this.isNullOrUndefined(token)){return}var authHeader={'Authorization':'Bearer '+token};if(this.isNullOrUndefined(opts.headers)){opts.headers={}}this.extend(opts.headers,authHeader)},login:function(opts){var success=opts.success;var o={url:"Auth/Login"};this.extend(o,opts);o.success=function(data,textStatus,jqXHR){var store=window.localStorage;store.setItem(meta.options.tokenName,data[meta.options.tokenName]);if(success){success(data,textStatus,jqXHR)}}this.post(o)},logout:function(opts){var store=window.localStorage;store.removeItem(meta.options.tokenName);if(opts&&opts.url){windows.location.href=opts.url}},getValue:function(elem){if(elem instanceof HTMLInputElement){if(elem.type==="checkbox"){return elem.checked}else{return elem.value}else if(elem instanceof HTMLSelectElement){if(elem.multiple){var value=[];var collection=elem.selectedOptions;for(var i=0;i<collection.length;i+=1){value.push(collection[i].value)}return value}}}else{return elem.value}else if(elem&&elem.innerHTML){return elem.innerHTML}},scrape:function(){var jsonRequest={};var attrName=meta.options.attrName;var elems=this.selectAll("["+attrName+"]");for(var i=0;i<elems.length;i+=1){if(elems[i]instanceof HTMLTableElement||elems[i]instanceof HTMLUListElement){continue}if(elems[i].hasAttribute(meta.options.attrScrapeName)){var scrapeit=JSON.parse(elems[i].getAttribute(meta.options.attrScrapeName));if(scrapeit===false){continue}}jsonRequest[elems[i].getAttribute(attrName)]=meta.getValue(elems[i])}return jsonRequest},formatValue:function(elem,val){try{if(elem.hasAttribute(meta.options.attrTypeName)){var type=elem.getAttribute(meta.options.attrTypeName);if(type===meta.dataTypesEnum.string){}else if(type===meta.dataTypesEnum.number){val=new Number(val)}else if(type===meta.dataTypesEnum.date||type===meta.dataTypesEnum.time||type===meta.dataTypesEnum.datetime||type===meta.dataTypesEnum.month||type===meta.dataTypesEnum.month1||type===meta.dataTypesEnum.month3||type===meta.dataTypesEnum.monthNum||type===meta.dataTypesEnum.monthNumPad||type===meta.dataTypesEnum.day||type===meta.dataTypesEnum.day1||type===meta.dataTypesEnum.day2||type===meta.dataTypesEnum.day3||type===meta.dataTypesEnum.dayNum||type===meta.dataTypesEnum.dayNumPad||type===meta.dataTypesEnum.year||type===meta.dataTypesEnum.year2){val=new Date(val);if(type===meta.dataTypesEnum.date){val=val.toLocaleDateString()}else if(type===meta.dataTypesEnum.time){val=val.toLocaleTimeString()}else if(type===meta.dataTypesEnum.datetime){val=val.toLocaleString()}else if(type===meta.dataTypesEnum.month){var monthNames=['January','February','March','April','May','June','July','August','September','October','November','December'];val=monthNames[val.getMonth()]}else if(type===meta.dataTypesEnum.month1){var month1Names=['J','F','M','A','M','J','J','A','S','O','N','D'];val=monthNames[val.getMonth()]}else if(type===meta.dataTypesEnum.month3){var month3Names=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];val=monthNames[val.getMonth()]}else if(type===meta.dataTypesEnum.monthNum){val=val.getMonth()+1}else if(type===meta.dataTypesEnum.monthNumPad){var month=val.getMonth()+1;val=month<10?'0'+month.toString():month.toString()}else if(type===meta.dataTypesEnum.day){var dayNames=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];val=dayNames[val.getDay()]}else if(type===meta.dataTypesEnum.day1){var day1Names=['S','M','T','W','T','F','S'];val=day1Names[val.getDay()]}else if(type===meta.dataTypesEnum.day2){var day2Names=['Su','Mo','Tu','We','Th','Fr','Sa'];val=day2Names[val.getDay()]}else if(type===meta.dataTypesEnum.day3){var day3Names=['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];val=day3Names[val.getDay()]}else if(type===meta.dataTypesEnum.dayNum){val=val.getDate()}else if(type===meta.dataTypesEnum.dayNumPad){var day=val.getDate();val=day<10?'0'+day.toString():day.toString()}else if(type===meta.dataTypesEnum.year){val=val.getFullYear()}else if(type===meta.dataTypesEnum.year2){var year=val.getFullYear();if(year>-10&&year<10){if(year<0){val='-0'+(year*-1).toString()}else{val='0'+year.toString()}}else if(year<100&&year>-100){val=year}else{var yearStr=year.toString();yearStr=year.substr(yearStr.length-2,2);if(year<0){yearStr='-'+yearStr}val=parseInt(yearStr)}}}else if(type===meta.dataTypesEnum.json){val=JSON.stringify(val)}}}catch(e){}return val},setValue:function(elem,val){val=meta.formatValue(elem,val);if(elem instanceof HTMLSelectElement){elem.value=val ;}else if(elem instanceof HTMLInputElement){if(elem.type==="checkbox"){elem.checked=val}else{elem.value=val }}else{elem.innerHTML=val}},paint:function(data,container){container=container||document;var attrName=meta.options.attrName;var elems=this.selectAll("["+attrName+"]",container);for(var i=0;i<elems.length;i+=1){var value=null;if(elems[i].hasAttribute(meta.options.attrMemberName)){var member=elems[i].getAttribute(meta.options.attrMemberName);if(member&&data[member]){value=data[member][elems[i].getAttribute(attrName)]}}else{value=data[elems[i].getAttribute(attrName)]}if(!meta.isNullOrUndefined(value)){meta.setValue(elems[i],value)}else{meta.log('metascraper::paint','unable to find data-value ['+elems[i].getAttribute(attrName)+']',meta.modes.warning)}}},fill:function(elem,data){var a,linkText;var dataValue=elem.getAttribute(meta.options.attrName);if(elem instanceof HTMLSelectElement){if(this.isNullOrUndefined(dataValue)||!elem.hasAttribute(meta.options.attrTextName)){return}var dataText=elem.getAttribute(meta.options.attrTextName);var className=elem.getAttribute(meta.options.attrClassName);for(var x=0;x<data.length;x+=1){var opt1=document.createElement("option");if(className&&className.length>0){opt1.classList.add(className)}opt1.value=data[x][dataValue];opt1.text=meta.formatValue(elem,data[x][dataText]);elem.add(opt1,null)}}else if(elem instanceof HTMLTableElement){var thead=elem.tHead;if(this.isNullOrUndefined(thead)||this.isNullOrUndefined(thead.rows)||thead.rows.length===0){return}var headCells=thead.rows[0].cells;if(this.isNullOrUndefined(headCells)||headCells.length===0){return}var rowHref=meta.getElemAttr(thead.rows[0],meta.options.attrHrefName);var rowClick=meta.getElemAttr(thead.rows[0],meta.options.attrClickName);var rowClass=meta.getElemAttr(thead.rows[0],meta.options.attrClassName);for(var r=0;r<data.length;r+=1){var tbody=elem.tBodies[0];if(meta.isNullOrUndefined(tbody)){tbody=elem.appendChild(document.createElement('tbody'))}var tr=tbody.insertRow(-1);if(rowHref&&rowHref.length>0&&rowClick&&rowClick.length>0){throw 'ERROR reported by '+meta.projectName+'. Cannot apply '+meta.options.attrHrefName+' and '+meta.options.attrClickName+' to a tr element.'}if(rowHref&&rowHref.length>0){var rowHrefVal=dataValue.length>0?rowHref.replace(meta.options.indexName,data[r][dataValue]):rowHref;tr.setAttribute("onclick","location.href = '"+rowHrefVal+"'")}if(rowClick&&rowClick.length>0){var rowClickVal=dataValue.length>0?rowClick.replace(meta.options.indexName,data[r][dataValue]):rowClick;tr.setAttribute("onclick",rowClickVal)}if(rowClass&&rowClass.length>0){tr.classList.add(rowClass)}for(var c=0;c<headCells.length;c+=1){var td=tr.insertCell(-1);if(!headCells[c].hasAttribute(meta.options.attrTextName)){continue}var cellHref=meta.getElemAttr(headCells[c],meta.options.attrHrefName);var cellClick=meta.getElemAttr(headCells[c],meta.options.attrClickName);var dataColumnValue=headCells[c].getAttribute(meta.options.attrTextName);var cellClass=meta.getElemAttr(headCells[c],meta.options.attrClassName);if(cellClass&&cellClass.length>0){td.classList.add(cellClass)}if(!(data[r][dataColumnValue]===undefined)){var cellText=meta.formatValue(headCells[c],data[r][dataColumnValue]);if(cellHref&&cellHref.length>0){a=document.createElement('a');linkText=document.createTextNode(cellText);a.appendChild(linkText);if(cellClick&&cellClick.length>0){a.setAttribute("onclick",cellClick.replace(meta.options.indexName,data[r][dataValue]))}a.href=cellHref.replace(meta.options.indexName,data[r][dataValue]);td.innerHTML=a.outerHTML}else{td.innerHTML=cellText;if(cellClick&&cellClick.length>0){td.setAttribute("onclick",cellClick.replace(meta.options.indexName,data[r][dataValue]))}}}}}}else if(elem instanceof HTMLUListElement){var ulDataText=meta.getElemAttr(elem,meta.options.attrTextName);if(!ulDataText){return}var ulHref=meta.getElemAttr(elem,meta.options.attrHrefName);var ulClick=meta.getElemAttr(elem,meta.options.attrClickName);var ulClassName=meta.getElemAttr(elem,meta.options.attrClassName);for(var i=0;i<data.length;i+=1){var li=document.createElement("li");if(ulClassName&&ulClassName.length>0){li.classList.add(ulClassName)}var liText=meta.formatValue(elem,data[i][ulDataText]);if(ulHref&&ulHref.length>0){a=document.createElement('a');linkText=document.createTextNode(liText);a.appendChild(linkText);if(ulClick&&ulClick.length>0){a.setAttribute("onclick",ulClick.replace(meta.options.indexName,data[i][dataValue]))}a.href=ulHref.replace(meta.options.indexName,data[i][dataValue]);li.appendChild(a)}else{li.appendChild(document.createTextNode(liText));if(ulClick&&ulClick.length>0){li.setAttribute("onclick",ulClick.replace(meta.options.indexName,data[i][dataValue]))}}if(data[i][dataValue]){li.setAttribute("id",data[i][dataValue]);}elem.appendChild(li)}}},populate:function(data,container){container=container||document;var attrArrayName=meta.options.attrArrayName;var elems=this.selectAll("["+attrArrayName+"]",container);for(var i=0;i<elems.length;i+=1){var fillData=data[elems[i].getAttribute(attrArrayName)]?data[elems[i].getAttribute(attrArrayName)]:data;meta.fill(elems[i],fillData)}},bind:function(data,container){container=container||document;meta.populate(data,container);meta.paint(data,container)},load:function(opts){var success=opts.success;var elem=opts.elem;var o={method:"GET",url:opts.url};this.extend(o,opts);o.success=function(data,textStatus,jqXHR){if(o.loadType===meta.loadTypesEnum.BeforeBeginAppend){elem.outerHTML=data+elem.outerHTML}else if(o.loadType===meta.loadTypesEnum.AfterBeginAppend){elem.innerHTML=data+elem.innerHTML}else if(o.loadType===meta.loadTypesEnum.BeforeEndAppend){elem.innerHTML=elem.innerHTML+data}else if(o.loadType===meta.loadTypesEnum.AfterEndAppend){elem.innerHTML=elem.outerHTML+data}else{elem.innerHTML=data}if(success){success(data,textStatus,jqXHR)}}this.ajax(o)},loadHeader:function(opts){var o={elem:document.body,loadType:meta.loadTypesEnum.AfterBeginAppend};this.extend(o,opts);this.load(o)},loadFooter:function(opts){var o={elem:document.body,loadType:meta.loadTypesEnum.BeforeEndAppend};this.extend(o,opts);this.load(o)},loadScript:function(opts){var success=opts.success;var o={method:"GET"};meta.extend(o,opts);o.success=function(data,textStatus,jqXHR){var script=document.createElement('script');script.textContent=data;document.head.appendChild(script);if(success){success(data,textStatus,jqXHR)}}meta.ajax(o)},data:{},store_set:function(name,data,type,expiryhours){type=type||meta.storeTypesEnum.Forever;expiryhours=expiryhours||720;var dataStr=this.toString(data);var now=new Date();var obj={value:dataStr,type:type,expiry:expiryhours,created:now.getTime(),lastread:now.getTime()};var storage=type===meta.storeTypesEnum.Session?window.sessionStorage:window.localStorage;var objStr=JSON.stringify(obj);storage.setItem(name,objStr)},store_get:function(name){var storage=window.localStorage;var json=storage.getItem(name);if(this.isNullOrUndefined(json)){storage=window.sessionStorage;json=storage.getItem(name)}if(this.isNullOrUndefined(json)){return null}try{var obj=JSON.parse(json);var expiry,now;if(obj.type===meta.storeTypesEnum.Session){return obj.value}else if(obj.type===meta.storeTypesEnum.Forever){return obj.value}else if(obj.type===meta.storeTypesEnum.OneTimeRead){var value=obj.value;storage.setItem(name,null);return value}else if(obj.type===meta.storeTypesEnum.ExpiryNoExtend){expiry=new Date();expiry.setTime(obj.created);expiry.setMinutes(expiry.getMinutes()+obj.expiry);now=new Date();if(now.getTime()<=expiry.getTime()){return obj.value}}else if(obj.type===meta.storeTypesEnum.ExpiryExtend){expiry=new Date();expiry.setTime(obj.lastread);expiry.setMinutes(expiry.getMinutes()+obj.expiry);now=new Date();if(now.getTime()<=expiry.getTime()){obj.lastread=now.getTime();storage.setItem(name,JSON.stringify(obj));return obj.value}}}catch(e){meta.log('metascraper::store_get','error getting value: ['+name+'], error: ['+meta.toString(e)+'], returning null',meta.modes.warning)}return null},filter:function(jsonArray,key,value,first){var arr=[];for(var i=0;i<jsonArray.length;i+=1){if(jsonArray[i][key]===value){if(first){return jsonArray[i]}else{arr.push(jsonArray[i])}}}return arr},getUrlParam:function(name,url){if(!url){url=window.location.href}name=name.replace(/[\[\]]/g,"\\$&");var regex=new RegExp("[?&]"+name+"(=([^&#]*)|&|#|$)"),results=regex.exec(url);if(!results){return null}if(!results[2]){return ''}return decodeURIComponent(results[2].replace(/\+/g," "))},getElemAttr:function(elem,attrName){if(elem&&elem.hasAttribute&&elem.getAttribute&&elem.hasAttribute(attrName)){return elem.getAttribute(attrName)}return ''},unique:function(){var d=new Date();return d.getTime()},copy:function(src){if(src===null||typeof src!=="object"){return src}if(src instanceof Node){if(src.outerHTML){return this.parseHTML(src.outerHTML)}else{return src.cloneNode(true)}}if(src instanceof NodeList){var docfrag=document.createDocumentFragment();var len=src.childNodes?src.childNodes.length:src.length;var orig;var copy;for(var i=0;i<len;i+=1){orig=null;if(src.childNodes&&src.childNodes.length&&src.childNodes[i]){orig=src.childNodes[i]}else if(src.length&&src[i]){orig=src[i]}if(this.isNullOrUndefined(orig)){continue}copy=this.copy(orig);docfrag.appendChild(copy)}return docfrag}if(src.constructor===Array||src.constructor===Object){try{return JSON.parse(JSON.stringify(src))}catch(jsonErr){console.log('Error: meta.copy: unable to parse source as json')}}if(src.constructor===Date){var target=new Date();target.setTime(src.getTime());return target}return new src.constructor(src)},toString:function(src){if(src===null||typeof src!=="object"){return src+''}if(src.constructor===Array||src.constructor===Object){try{return JSON.stringify(src)}catch(jsonErr){console.log('Error: meta.toString: unable to parse source as json')}}if(src instanceof Node){if(src.outerHTML){return src.outerHTML}}if(src instanceof NodeList){var html='';if(src&&src.childNodes&&src.childNodes.length&&src.childNodes.length>0){for(var i=0;i<src.childNodes.length;i+=1){if(this.isNullOrUndefined(src.childNodes[i])){continue}if(src.childNodes[i].outerHTML){html+=src.childNodes[i].outerHTML}else if(src.childNodes[i].textContent){html+=src.childNodes[i].textContent}}}return html}return src.toString()},log:function(funcName,description,mode){if(mode>=this.options.mode){var msg=funcName+'::'+description;switch(mode){case this.modes.error:console.error?console.error("ERROR  "+msg):console.log("ERROR  "+msg);break;case this.modes.warning:console.warn?console.warn("WARNING  "+msg):console.log("WARNING  "+msg);break;default:console.log(msg)}}},tryParseJsonObject:function(jsonString){try{var o=JSON.parse(jsonString);if(o&&typeof o==="object"){return o}}catch(e){this.log('meta.tryParseJsonObject','Unable to parse value - error: '+e+' - value: '+meta.toString(jsonString),this.modes.warning)}return false},isJson:function(json){try{var jsonStr=JSON.stringify(json);return this.tryParseJsonObject(jsonStr)!==false}catch(e){this.log('meta.isJson','error: '+e+' - value: '+meta.toString(jsonString),this.modes.warning)}return false},eachJsonKey:function(json,f){for(var i=0;i<Object.keys(json).length;i+=1){var key=Object.keys(json)[i];f(key,json[key])}},versionCheck:function(semVer,requiredSemVer){if(semVer===requiredSemVer){return true}var semVerArr=semVer.toString().split('.');var requiredSemVerArr=requiredSemVer.toString().split('.');for(var i=0;i<requiredSemVerArr.length;i+=1){if(semVerArr.length===i){return false}if(parseInt(semVerArr[i])>parseInt(requiredSemVerArr[i])){return true}if(parseInt(semVerArr[i])<parseInt(requiredSemVerArr[i])){return false}}return true},async:function(f,options){window.setTimeout(function(){var opts={data:void 0,success:function(){},error:function(){var status=textStatus||'Unhandled Error';throw{"errorThrown":errorThrown,"textStatus":status}}};meta.extend(opts,options);try{var val=f(opts.data);opts.success(val)}catch(e){opts.error(e)}},1,options)},isNullOrUndefined:function(val){return val===null||val===void 0},extend:function(target,src){for(var key in src){var srcVal=src[key];if(srcVal===null||typeof srcVal!=='object'||srcVal instanceof Node){target[key]=srcVal}else if(src.constructor===Date){var d=new Date();d.setTime(srcVal.getTime());target[key]=d}else{if(this.isNullOrUndefined(target[key])){target[key]=Array.isArray(src)?[]:{}}target[key]=this.extend(target[key],srcVal)}}return target},ajax:function(opts){var xhr=new XMLHttpRequest();var options={method:'GET',async:true,headers:{},key:"",success:function(data,textStatus,xhr){},error:function(xhr,textStatus,errorThrown){var status=textStatus||'Unhandled Error';throw{"errorThrown":errorThrown,"textStatus":status}}};this.extend(options,this.ajaxSetup);this.extend(options,opts);if(!options.url){throw new Error('url parameter must be set.','Missing option')}options.method=options.method.toUpperCase();var requestMethods=['GET','POST','PUT','DELETE'];if(requestMethods.indexOf(options.method)<0){throw 'Request method "'+options.method+'" is not supported. Use one of GET | POST | PUT | DELETE'}xhr.addEventListener("readystatechange",function(e){if(xhr.readyState===4){if(options.statusCode&&options.statusCode[xhr.status]){options.statusCode[xhr.status](xhr.response,xhr.statusText,xhr);options.error(xhr,xhr.statusText,xhr.response)}else{if(xhr.status===200){var responseData;try{responseData=JSON.parse(xhr.response)}catch(e){responseData=xhr.response}if(options.key.length>0){meta.data[options.key]=responseData}options.success(responseData,xhr.statusText,xhr)}else{options.error(xhr,xhr.statusText,xhr.response)}}}},false);xhr.open(options.method,options.url,options.async);xhr.setRequestHeader('X-Requested-With','XMLHttpRequest');this.eachJsonKey(options.headers,function(key,value){xhr.setRequestHeader(key,value)});if(options.data instanceof FormData){xhr.send(options.data)}else{try{if(options.data&&typeof options.data!=="string"){options.data=meta.toString(options.data)}xhr.setRequestHeader('Content-Type','application/json');xhr.send(options.data)}catch(e){throw new e}}},ajaxSetup:{},ready:function(f){var state=document.readyState;if(state==='interactive'||state==='complete'){f()}else{setTimeout(function(){meta.ready(f)},100)}},select:function(id){return document.getElementById(id)},selectAll:function(filter,container){container=container||document;return container.querySelectorAll(filter)},parseHTML:(function(){var rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rhtml=/<|&#?\w+;/,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};return function parseHTML(html,context){if(this.isNullOrUndefined(html)){return null}context=context||document;var tmp,tag,wrap,j,fragment=context.createDocumentFragment();if(!rhtml.test(html)){fragment.appendChild(context.createTextNode(html));}else{tmp=fragment.appendChild(context.createElement("div"));tag=(rtagName.exec(html)||["",""])[1].toLowerCase();wrap=wrapMap[tag]||wrapMap._default;tmp.innerHTML=wrap[1]+html.replace(rxhtmlTag,"<$1></$2>")+wrap[2];j=wrap[0];while(j--){tmp=tmp.lastChild}fragment.removeChild(fragment.firstChild);while(tmp.firstChild){fragment.appendChild(tmp.firstChild)}}return fragment}}())};